"use strict";(self["webpackChunkoffender"]=self["webpackChunkoffender"]||[]).push([[97],{2097:function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});s(7658);var a=s(6252),l=s(3577),i=s(9963),n=s(2262),o=s(3560),r=s(9530),c=s(2244),p=s(2201),d=s(3002);function u(e,t){return(0,a.wg)(),(0,a.j4)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[(0,a.Wm)("path",{d:"M11 6a3 3 0 11-6 0 3 3 0 016 0zM14 17a6 6 0 00-12 0h12zM13 8a1 1 0 100 2h4a1 1 0 100-2h-4z"})])}var m=s(3530);const w=e=>((0,a.dD)("data-v-5eec6598"),e=e(),(0,a.Cn)(),e),x={class:"bg-gray-900"},f={class:"mx-auto members"},h={class:"bg-gray-900 py-20"},g={class:""},v=w((()=>(0,a._)("div",{class:"sm:flex sm:items-center"},[(0,a._)("div",{class:"sm:flex-auto"},[(0,a._)("h1",{class:"text-2xl font-semibold leading-6 text-white"},"Members"),(0,a._)("p",{class:"mt-2 text-sm text-gray-300"},"List of all the users")])],-1))),y={class:"mt-8 flow-root"},_={class:"-my-2 overflow-x-auto"},b={class:"inline-block min-w-full py-2 align-middle"},k={class:"min-w-full divide-y divide-gray-700"},z=w((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-0"},"Name"),(0,a._)("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-0"},"Email"),(0,a._)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-white"},"Plan"),(0,a._)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-white"},"Rows Total"),(0,a._)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-white"},"Rows Remaining"),(0,a._)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-white"},"Reset Password"),(0,a._)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-white"},"Remove")])],-1))),C={class:"divide-y divide-gray-800"},U={class:"py-4 pl-4 pr-3 text-sm font-medium text-white sm:pl-0"},D={class:"w-48 truncate"},R={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-white sm:pl-0"},M={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-300 capitalize"},P=["onUpdate:modelValue","onChange"],q=["value"],A={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-300"},H={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-300"},S=["onClick"],$={class:"whitespace-nowrap px-3 py-4 text-sm"};var I=(0,a.aZ)({__name:"Users",setup(e){const t=(0,o.L)(),s=(0,r.W)(),w=(0,p.tv)(),I=(0,d.pm)(),L=(0,m.d)("confirm"),N=(0,n.iH)([]),E=(0,n.iH)(""),W=(0,n.iH)("");(0,a.bv)((async()=>{if(!t.userId)return;const e=await t.fetchAllUser();N.value=e?.filter((e=>e._id!==t.userId)),s.plans.length||await s.fetchPlans()})),(0,a.YP)((()=>t.isLoading),(()=>{t.isLoading||t.user?.role===c.u.ADMIN||w.push("/detect")}));const Y=(0,a.Fl)((()=>s.plans)),K=e=>{const t=Y.value.find((t=>t._id===e));return t||null},V=async e=>{const s=await t.resetPasswordEmail(e,!0);s?I.success("Sent email!"):I.error("Something went wrong!")},Z=async()=>{if(!t.user||!W.value||!E.value)return;const e={plan:W.value};await t.updateUser(E.value,e)},j=async(e,s)=>{t.user&&(W.value=e.target.value,E.value=s,L.show({title:"Change Plan",message:"Are you sure you want to change plan for user?",confirm:Z}))},B=async()=>{if(!E.value)return;const e=await t.removeUser(E.value);if(e){N.value=[];const e=await t.fetchAllUser();N.value=e?.filter((e=>e._id!==t.user?._id))}else I.error("Something went wrong!")},F=async e=>{E.value=e,L.show({title:"Delete User",message:"Are you sure you want to delete user?",confirm:B})};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",x,[(0,a._)("div",f,[(0,a._)("div",h,[(0,a._)("div",g,[v,(0,a._)("div",y,[(0,a._)("div",_,[(0,a._)("div",b,[(0,a._)("table",k,[z,(0,a._)("tbody",C,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(N.value,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.email},[(0,a._)("td",U,[(0,a._)("div",D,(0,l.zw)(e.userName),1)]),(0,a._)("td",R,(0,l.zw)(e.email),1),(0,a._)("td",M,[(0,a.wy)((0,a._)("select",{id:"plan",name:"plan","onUpdate:modelValue":t=>e.plan=t,class:"capitalize block rounded-md border-0 bg-white bg-opacity-5 py-1 text-white shadow-sm ring-1 ring-inset ring-white/10 focus:ring-2 focus:ring-inset focus:ring-indigo-500 sm:text-sm sm:leading-6",onChange:t=>j(t,e._id)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Y.value,(e=>((0,a.wg)(),(0,a.iD)("option",{key:e._id,value:e._id,class:"capitalize text-black"},(0,l.zw)(`${e.name}: ${e.requests} rows per ${e.frequency} `),9,q)))),128))],40,P),[[i.bM,e.plan]])]),(0,a._)("td",A,(0,l.zw)(`${K(e.plan)?.requests} / ${K(e.plan)?.frequency}`),1),(0,a._)("td",H,(0,l.zw)(e.availableRequests),1),(0,a._)("td",{class:"whitespace-nowrap px-3 py-4 text-sm text-gray-300 cursor-pointer",onClick:t=>V(e.userName)}," Send Reset Email ",8,S),(0,a._)("td",$,[(0,a.Wm)((0,n.SU)(u),{class:"text-red-600 w-6 ml-4 cursor-pointer","aria-hidden":"true",onClick:t=>F(e._id)},null,8,["onClick"])])])))),128))])])])])])])])])]))}}),L=s(3744);const N=(0,L.Z)(I,[["__scopeId","data-v-5eec6598"]]);var E=N}}]);